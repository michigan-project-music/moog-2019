<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Accelerometer Javascript Test</title>
<meta name="viewport" content="width=device-width,user-scalable=yes" />
<script src="https://www.gstatic.com/firebasejs/5.8.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.8.2/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.8.2/firebase-database.js"></script>	
</head>

<body>
<div id="content">
    <h1>Accelerometer Javascript Test</h1>
    <div id="sphere"></div>
<ul>
	<li>acceleration x: <span id="accelerationX"></span>g</li>
	<li>acceleration y: <span id="accelerationY"></span>g</li>
	<li>acceleration z: <span id="accelerationZ"></span>g</li>
	<li>start time: <span id="timeStart"></span>g</li>
	<li>current time: <span id="currentTime"></span>g</li>
</ul>

test: <span id="test"></span>
</div>
<div class="slidecontainer">
  <input type="range" min="1" max="100" value="50" class="slider" id="myRange">
  <p>Value: <span id="sensitivity"></span></p>
</div>
<script type="text/javascript">
	const DURATION_MILLIS = 350;
	const SENSITIVITY = 4.5;
	let time_start = Number.MAX_SAFE_INTEGER - 2000;
	var config = {
	    apiKey: "AIzaSyDBFJtzxQgl3JkPKwOJCVCQEsqnp16J5OM",
	    authDomain: "test-playground-b36c0.firebaseapp.com",
	    databaseURL: "https://test-playground-b36c0.firebaseio.com",
	    projectId: "test-playground-b36c0",
	    storageBucket: "test-playground-b36c0.appspot.com",
	    messagingSenderId: "103494638490"
  	};
	firebase.initializeApp(config);
	document.getElementById("timeStart").innerHTML = time_start;	
	document.getElementById("currentTime").innerHTML = Date.now();	

	if (window.DeviceMotionEvent != undefined) {
		window.ondevicemotion = function(e) {
			document.getElementById("accelerationX").innerHTML = e.acceleration.x;
			document.getElementById("accelerationY").innerHTML = e.acceleration.y;
			document.getElementById("accelerationZ").innerHTML = e.acceleration.z;	
			document.getElementById("timeStart").innerHTML = time_start;	
			document.getElementById("currentTime").innerHTML = Date.now();	
			if ((e.acceleration.x > SENSITIVITY || e.acceleration.y > SENSITIVITY || e.acceleration.y > SENSITIVITY) && (Date.now() < (time_start + DURATION_MILLIS))) {
				time_start = Date.now();
				document.body.style.backgroundColor = "red";
				firebase.database().ref("VCO").set({
					value: Math.random() * 3
				})
			}
			else if (Date.now() >= time_start + DURATION_MILLIS) {
				time_start = Number.MAX_SAFE_INTEGER - 2000;
				document.body.style.backgroundColor = "white";
			}
		}
	} 

  var slider = document.getElementById("myRange");
  var output = document.getElementById("sensitivity");
  output.innerHTML = slider.value; // Display the default slider value

  // Update the current slider value (each time you drag the slider handle)
  slider.oninput = function() {
    output.innerHTML = this.value;
  }
</script>

</body>
</html>
